{% extends "bi/base.html" %}
{% load static %}

{% block titulo %} Restablecer Contraseña {% endblock %}

{% block statics %}
<link rel="stylesheet" href="{% static 'bi/css/styleLogin.css'%}">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
{% endblock %}

{% block classBody %}
{% endblock %}

{% block classDiv %}
class="d-flex align-items-center py-4 fondoLogin"
{% endblock %}

{% block navbar %}

{% endblock %}

{% block contenido %}
<form method="POST" class="w-100" style="max-width: 400px; margin:auto;">
    {% csrf_token %}
    <div class="card shadow-lg rounded-4 p-4 position-relative formLogin text-light">
        <!-- Contenedor del logo -->
        <div class="d-flex justify-content-center" style="margin-top:-50px;">
            <img src="{% static 'bi/img/logo-fenix-ID.png'%}" alt="Logo Fenix" width="72"
                height="72" class="rounded-circle">
        </div>

        <h1 class="h4 mb-4 text-center fw-bold">Restablecer Contraseña</h1>

        <!-- Mensajes de error -->
        {% if error %}
        <div class="alert alert-danger alert-dismissible fade show" role="alert">
            <strong>Error:</strong> {{ error }}
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
        {% endif %}

        <!-- Nueva contraseña -->
        <div class="form-floating mb-3">
            <input type="password" name="new_password" class="form-control" id="floatingPassword" placeholder="" required>
            <label for="floatingPassword">Nueva Contraseña</label>
        </div>

        <!-- Confirmar contraseña -->
        <div class="form-floating mb-3">
            <input type="password" name="confirm_password" class="form-control" id="floatingConfirmPassword" placeholder="" required>
            <label for="floatingConfirmPassword">Confirmar Contraseña</label>
        </div>

        <!-- Botón -->
        <button class="btn btn-primary w-100 py-2 fw-bold" type="submit">Restablecer Contraseña</button>

        <!-- Pie opcional -->
        <p class="text-center mt-3 mb-0 small text-secondary">
            ¿Recordó su contraseña? <a href="{% url 'login' %}" class="text-light text-decoration-underline">Iniciar Sesión</a>
        </p>
    </div>
</form>

{% endblock %}

{% block footer %}
<script>
// Validación simple de contraseñas
document.querySelector('form').addEventListener('submit', function(e) {
    const newPassword = document.getElementsByName('new_password')[0].value;
    const confirmPassword = document.getElementsByName('confirm_password')[0].value;
    
    if (newPassword !== confirmPassword) {
        e.preventDefault();
        alert('Las contraseñas no coinciden');
        return false;
    }
    
    if (newPassword.length < 8) {
        e.preventDefault();
        alert('La contraseña debe tener al menos 8 caracteres');
        return false;
    }
});
</script>
{% endblock %}